<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GrowAGarden Plant Mutation Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 1em auto;
    padding: 1em;
    background: #f0f8ff;
    color: #333;
  }
  label {
    font-weight: bold;
    display: block;
    margin-top: 1em;
  }
  select, input[type=number] {
    width: 100%;
    padding: 0.4em;
    margin-top: 0.2em;
    font-size: 1em;
  }
  .mutations {
    margin-top: 1em;
  }
  .mutation-group {
    margin-bottom: 1em;
  }
  .mutation-group label {
    font-weight: normal;
    margin-right: 1em;
  }
  .warning {
    color: red;
    font-weight: bold;
    margin-top: 1em;
  }
  .result {
    margin-top: 1.5em;
    font-size: 1.2em;
    font-weight: bold;
    background: #d1e7dd;
    padding: 1em;
    border-radius: 6px;
    color: #0f5132;
  }
</style>
</head>
<body>

<h1>GrowAGarden Mutation Calculator</h1>

<label for="plant">ðŸŒ¿ Plant Type</label>
<select id="plant"></select>

<label for="basePrice">Base Price (Gold)</label>
<input type="number" id="basePrice" min="0" step="0.01" />

<div class="mutations">
  <label>Growth Mutations (Choose one):</label>
  <div class="mutation-group" id="growthMutations">
    <label><input type="radio" name="growth" value="none" checked /> None</label>
    <label><input type="radio" name="growth" value="golden" /> Golden (Ã—20)</label>
    <label><input type="radio" name="growth" value="rainbow" /> Rainbow (Ã—50)</label>
  </div>

  <label>Environmental Mutations (Choose any, but restrictions apply):</label>
  <div class="mutation-group" id="envMutations">
    <label><input type="checkbox" name="env" value="wet" /> Wet (Ã—2)</label>
    <label><input type="checkbox" name="env" value="chilled" /> Chilled (Ã—2)</label>
    <label><input type="checkbox" name="env" value="chocolate" /> Chocolate (Ã—2)</label>
    <label><input type="checkbox" name="env" value="moonlit" /> Moonlit (Ã—2)</label>
    <label><input type="checkbox" name="env" value="bloodlit" /> Bloodlit (Ã—4)</label>
    <label><input type="checkbox" name="env" value="plasma" /> Plasma (Ã—5)</label>
    <label><input type="checkbox" name="env" value="frozen" /> Frozen (Ã—10)</label>
    <label><input type="checkbox" name="env" value="zombified" /> Zombified (Ã—25)</label>
    <label><input type="checkbox" name="env" value="twisted" /> Twisted (Ã—30)</label>
    <label><input type="checkbox" name="env" value="shocked" /> Shocked (Ã—100)</label>
    <label><input type="checkbox" name="env" value="celestial" /> Celestial (Ã—120)</label>
    <label><input type="checkbox" name="env" value="disco" /> Disco (Ã—125)</label>
  </div>
</div>

<div class="warning" id="warning" style="display:none;"></div>

<div class="result" id="result" style="display:none;"></div>

<script>
  // Plant list with example base prices (you can adjust these)
  const plants = {
    "apple": 5,
    "banana": 4,
    "bamboo": 3,
    "beanstalk": 7,
    "blood banana": 6,
    "blueberry": 5,
    "cactus": 4,
    "cacao": 6,
    "carrot": 3,
    "corn": 3,
    "cranberry": 5,
    "coconut": 7,
    "daffodil": 2,
    "dragonfruit": 8,
    "durian": 10,
    "eggplant": 4,
    "glowshroom": 6,
    "grape": 5,
    "mango": 7,
    "moon blossom": 6,
    "moon melon": 7,
    "moonflower": 6,
    "mushroom": 3,
    "nightshade": 5,
    "orangetulip": 2,
    "papaya": 6,
    "passionfruit": 7,
    "pear": 5,
    "peach": 6,
    "pepper": 4,
    "pumpkin": 5,
    "raspberry": 5,
    "soulfruit": 9,
    "strawberry": 5,
    "tomato": 4,
    "watermelon": 7
  };

  // Mutation multipliers
  const growthMutations = {
    none: 1,
    golden: 20,
    rainbow: 50
  };

  const envMutations = {
    wet: 2,
    chilled: 2,
    chocolate: 2,
    moonlit: 2,
    bloodlit: 4,
    plasma: 5,
    frozen: 10,
    zombified: 25,
    twisted: 30,
    shocked: 100,
    celestial: 120,
    disco: 125
  };

  // Environmental stacking bonuses (added to 1 in formula)
  const envStackBonus = {
    wet: 1,
    chilled: 1,
    chocolate: 1,
    moonlit: 1,
    bloodlit: 3,
    plasma: 4,
    frozen: 9,
    zombified: 24,
    shocked: 99,
    celestial: 119,
    disco: 124,
    twisted: 0 // unclear, treat as 0 or add if you want
  };

  // Restrictions:
  // Only one of Golden or Rainbow growth mutation
  // Only one of Wet, Chilled, or Frozen env mutations

  // Populate plant select with options
  const plantSelect = document.getElementById("plant");
  Object.entries(plants).forEach(([name, price]) => {
    const option = document.createElement("option");
    option.value = name;
    option.textContent = name[0].toUpperCase() + name.slice(1);
    plantSelect.appendChild(option);
  });

  // Set base price input based on selected plant
  const basePriceInput = document.getElementById("basePrice");
  function updateBasePrice() {
    const plant = plantSelect.value;
    basePriceInput.value = plants[plant] || 0;
  }
  plantSelect.addEventListener("change", () => {
    updateBasePrice();
    calculate();
  });

  basePriceInput.addEventListener("input", calculate);

  // Mutation inputs and event handlers
  const growthRadios = document.querySelectorAll('input[name="growth"]');
  const envCheckboxes = document.querySelectorAll('input[name="env"]');

  growthRadios.forEach(radio => {
    radio.addEventListener("change", () => {
      updateRestrictions();
      calculate();
    });
  });

  envCheckboxes.forEach(cb => {
    cb.addEventListener("change", () => {
      updateRestrictions();
      calculate();
    });
  });

  // Update disabled state of checkboxes based on restrictions
  function updateRestrictions() {
    const growthSelected = Array.from(growthRadios).find(r => r.checked)?.value || "none";
    const envSelected = Array.from(envCheckboxes).filter(cb => cb.checked).map(cb => cb.value);

    // Restrict Golden and Rainbow mutually exclusive: handled by radio inputs - no disable needed

    // Restrict only one of wet, chilled, frozen
    const wetChilledFrozen = ["wet", "chilled", "frozen"];
    const selectedWetChilledFrozen = envSelected.filter(m => wetChilledFrozen.includes(m));

    envCheckboxes.forEach(cb => {
      if (wetChilledFrozen.includes(cb.value)) {
        if (selectedWetChilledFrozen.length === 1 && !cb.checked) {
          cb.disabled = true;
        } else {
          cb.disabled = false;
        }
      } else {
        cb.disabled = false;
      }
    });
  }

  // Show warnings if restrictions violated (should not happen if disabling works)
  function checkWarnings() {
    const growthSelected = Array.from(growthRadios).find(r => r.checked)?.value || "none";
    const envSelected = Array.from(envCheckboxes).filter(cb => cb.checked).map(cb => cb.value);

    const warnings = [];

    // Golden vs Rainbow
    if (growthSelected === "golden" && growthSelected === "rainbow") {
      warnings.push("Cannot select both Golden and Rainbow mutations.");
    }

    // Wet, Chilled, Frozen mutually exclusive
    const wetChilledFrozen = ["wet", "chilled", "frozen"];
    const selectedWetChilledFrozen = envSelected.filter(m => wetChilledFrozen.includes(m));
    if (selectedWetChilledFrozen.length > 1) {
      warnings.push("Only one of Wet, Chilled, or Frozen can be selected.");
    }

    const warningEl = document.getElementById("warning");
    if (warnings.length) {
      warningEl.style.display = "block";
      warningEl.textContent = warnings.join(" ");
    } else {
      warningEl.style.display = "none";
      warningEl.textContent = "";
    }
  }

  // Calculate final price
  function calculate() {
    checkWarnings();

    const plant = plantSelect.value;
    let basePrice = parseFloat(basePriceInput.value);
    if (isNaN(basePrice) || basePrice < 0) {
      basePrice = 0;
      basePriceInput.value = 0;
    }

    const growthSelected = Array.from(growthRadios).find(r => r.checked)?.value || "none";
    const envSelected = Array.from(envCheckboxes).filter(cb => cb.checked).map(cb => cb.value);

    // Calculate growth multiplier
    const growthMultiplier = growthMutations[growthSelected] || 1;

    // Calculate environmental multiplier
    // Sum base multipliers and add stacking bonuses (formula is (sum multipliers + sum bonuses) * growthMultiplier * basePrice)
    // According to your earlier description:
    // Total = (GrowthMutation * BasePrice * (Sum of EnvMultipliers + Sum of EnvStackBonus))

    let envMultSum = 0;
    let envBonusSum = 0;

    envSelected.forEach(mutation => {
      envMultSum += (envMutations[mutation] || 0);
      envBonusSum += (envStackBonus[mutation] || 0);
    });

    // If no env mutation selected, multiplier + bonus = 1 for neutral effect
    if (envSelected.length === 0) {
      envMultSum = 1;
      envBonusSum = 0;
    }

    const total = growthMultiplier * basePrice * (envMultSum + envBonusSum);

    const resultEl = document.getElementById("result");
    resultEl.style.display = "block";
    resultEl.textContent = `Final Plant Price: ${total.toFixed(2)} Gold`;

    updateRestrictions();
  }

  // Initialize
  updateBasePrice();
  calculate();
</script>

</body>
</html>
